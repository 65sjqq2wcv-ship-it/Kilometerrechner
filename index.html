<!DOCTYPE html>
<html lang="de-DE">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="Content-Language" content="de-DE">
    <meta name="language" content="German">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover"/>
    <title>Kilometerrechner</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#667eea" />
    <meta
      name="theme-color"
      media="(prefers-color-scheme: light)"
      content="#667eea"
    />
    <meta
      name="theme-color"
      media="(prefers-color-scheme: dark)"
      content="#667eea"
    />
    <meta name="msapplication-navbutton-color" content="#667eea" />
    <meta name="apple-mobile-web-app-status-bar-style" content="#667eea" />

    <!-- iOS PWA Meta Tags - Erweitert -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="Kilometerrechner" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-touch-fullscreen" content="yes" />

    <!-- Additional iOS Meta Tags -->
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Android PWA -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Kilometerrechner" />

    <!-- Windows PWA -->
    <meta name="msapplication-TileColor" content="#667eea" />
    <meta name="msapplication-tap-highlight" content="no" />

    <!-- CSS und Fonts -->
    <link rel="stylesheet" href="styles.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png" />
    <link rel="apple-touch-icon" sizes="192x192" href="icon-192.png" />
  </head>
  <body>
    <div class="app-container">
      <!-- Hero Section -->
      <div class="hero-section">
        <div class="hero-content">
          <div class="title-section">
            <h1 class="app-title">Kilometerrechner</h1>
            <div class="app-version">v1.28</div>
          </div>
          
          <!-- Dropdown Menu neben dem Titel -->
          <div class="dropdown-menu">
            <button id="menuToggleBtn" class="primary-btn menu-toggle icon-menu">
              <i class="material-icons">more_vert</i>
            </button>
            <div id="dropdownContent" class="dropdown-content">
              <button id="addVehicleBtn" class="dropdown-item">
                <i class="material-icons">add_circle</i>
                <span>Fahrzeug hinzuf체gen</span>
              </button>
              <button id="backupBtn" class="dropdown-item">
                <i class="material-icons">backup</i>
                <span>Backup/Restore</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Content Section -->
      <div class="content-section">
        <div id="vehicleList" class="vehicle-grid"></div>
      </div>
    </div>

    <!-- Vehicle Modal -->
    <div id="vehicleModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">Fahrzeug hinzuf체gen</h2>
          <button class="close-btn" id="closeModalBtn">
            <i class="material-icons">close</i>
          </button>
        </div>
        <form id="vehicleForm">
          <div class="form-group">
            <label for="vehicleName">Fahrzeugname</label>
            <input
              type="text"
              id="vehicleName"
              required
              placeholder="z.B. BMW 320i"
            />
          </div>
          <div class="form-group">
            <label for="pickupDate">Tag der Abholung</label>
            <input type="date" id="pickupDate" required />
          </div>
          <div class="form-group">
            <label for="totalMileage">Gesamte Fahrleistung (km)</label>
            <input
              type="number"
              id="totalMileage"
              required
              min="1"
              placeholder="z.B. 20000"
            />
          </div>
          <div class="form-group">
            <label for="contractDuration">Vertragslaufzeit (Monate)</label>
            <input
              type="number"
              id="contractDuration"
              required
              min="1"
              placeholder="z.B. 36"
            />
          </div>
          <div class="form-actions">
            <button type="button" id="cancelBtn" class="btn btn-secondary">
              Abbrechen
            </button>
            <button type="submit" class="btn btn-primary">Speichern</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Backup/Restore Modal -->
    <div id="backupModal" class="modal">
      <div class="modal-content import-modal-content">
        <div class="modal-header">
          <h2>Backup/Restore</h2>
          <button class="close-btn" id="closeBackupModalBtn">
            <i class="material-icons">close</i>
          </button>
        </div>
        <div class="modal-body">
          <div class="import-content">
            <!-- Export Section -->
            <div class="backup-section">
              <h3><i class="material-icons">download</i> Backup erstellen</h3>
              <p>Exportieren Sie alle Ihre Fahrzeugdaten als JSON-Datei:</p>
              <button id="exportBtn" class="btn btn-primary">
                <i class="material-icons">download</i>
                Backup herunterladen
              </button>
            </div>

            <hr style="margin: 24px 0; border: none; border-top: 1px solid var(--border);">

            <!-- Import Section -->
            <div class="restore-section">
              <h3><i class="material-icons">upload</i> Backup wiederherstellen</h3>
              <div class="import-info">
                <p><strong>Hinweis:</strong> Das Wiederherstellen eines Backups 체berschreibt alle aktuellen Daten!</p>
              </div>

              <div class="file-upload-area" id="fileUploadArea">
                <div class="upload-icon">
                  <i class="material-icons">cloud_upload</i>
                </div>
                <p class="upload-text">
                  JSON-Backup-Datei hier ablegen oder klicken zum Ausw채hlen
                </p>
                <input type="file" id="jsonFileInput" accept=".json" hidden />
              </div>

              <div
                id="restorePreview"
                class="import-preview"
                style="display: none"
              >
                <h3>Restore-Vorschau:</h3>
                <div id="previewContent"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <div class="form-actions">
            <button
              type="button"
              id="cancelBackupBtn"
              class="btn btn-secondary"
            >
              Abbrechen
            </button>
            <button
              type="button"
              id="confirmRestoreBtn"
              class="btn btn-primary"
              style="display: none"
            >
              Wiederherstellen
            </button>
          </div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
